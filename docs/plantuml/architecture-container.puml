@startuml Container Diagram
title Container Diagram - Datadog RCA to Slack Integration with DICE

skinparam backgroundColor white
skinparam componentStyle rectangle
skinparam defaultTextAlignment center
skinparam shadowing false

skinparam rectangle {
    BackgroundColor<<external>> #FFECB3
    BorderColor<<external>> #FFA000
    BackgroundColor<<person>> #BBDEFB
    BorderColor<<person>> #1976D2
    BackgroundColor<<container>> #E1BEE7
    BorderColor<<container>> #7B1FA2
    BackgroundColor<<dice>> #D4EEFF
    BorderColor<<dice>> #63C0F5
}

' Users
rectangle "DevOps Engineer" <<person>> as devops

' External Systems
rectangle "Datadog\n//Monitoring platform//" <<external>> as datadog
rectangle "Slack\n//Team communication//" <<external>> as slack
rectangle "DICE Service\n//Spring Boot\nPropositionPipeline//" <<external>> as dice

' Embabel RCA Application
package "Embabel RCA Application" {
    rectangle "RCA Agent\n//Kotlin//\nAI orchestrator" <<container>> as rca_agent
    rectangle "Webhook Server\n//Spring Boot//\nHTTP server" <<container>> as webhook_server
    rectangle "Datadog Client\n//Kotlin//\nREST API client" <<container>> as datadog_client

    ' DICE Integration components
    rectangle "DICE Client\n//Kotlin//\n/ingest & /memory" <<dice>> as dice_client
    rectangle "DICE Ingestion Service\n//Kotlin//\nreport processing" <<dice>> as dice_ingestion

    rectangle "Chat Client\n//Kotlin//\nSlack/Teams client" <<container>> as chat_client
}

' Relationships
devops --> datadog : Monitors systems
datadog --> webhook_server : HTTP POST
webhook_server --> rca_agent : Triggers

' Datadog enrichment
rca_agent --> datadog_client : Uses
datadog_client --> datadog : REST API

' DICE integration (following DICE API)
rca_agent --> dice_ingestion : Report processing
dice_ingestion --> dice_client : chunks, sourceId
dice_client --> dice : POST /ingest
dice_client --> dice : GET /memory

' Chat output
rca_agent --> chat_client : Uses
chat_client --> slack : Webhook API
slack --> devops : Delivers alerts

@enduml
